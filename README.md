本コードでは、クライアントアプリから、 Microsoft Graph を介して M365 の情報からデータを獲得し利用する web アプリへと、ユーザーがアクセスし実際に操作を行うフローのうち、
サインインやキャッシュの保存といった機能を実装しております。

Web アプリが連携する製品として今回は M365 を選択いたしましたが、
Azure SQL データベースなどほかの製品を使っていただくことも可能となっております。

Azure AD 認証と M365 との連携のため、新規に作成いただく必要があるファイルは以下の 3 つとなっております。
- oauth_setting.yml
- auth_helper.py
- graph_helper.py

oauth_setting.yml には、AAD 認証に必要な各 ID やパスワード等を記載していただきます。

auth_helper.py には、Micrososft 認証ライブラリ (MSAL) を使用して、キャッシュの更新やアクセストークンの提供といった、 Azure AD 認証を行う際に必要なアクションを記載していただきます。
そのため、例えば views.py 内に記載されているサインインにかかわる関数にて、 auth_helper.py に含まれる関数が使われております。

graph_helper.py には、M365 との連携に必要なアクションを記載していただきます。
なお、現時点でのコード内容では M365 との連携までは実装されておりませんので、ご注意ください。
